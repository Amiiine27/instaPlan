package org.example.projets2;

import org.example.projets2.dao.*;
import org.example.projets2.model.*;
import org.example.projets2.util.DatabaseInitializer;

import java.sql.SQLException;
import java.time.LocalDate;
import java.time.LocalTime;
import java.util.List;

public class MainTestAll {

    public static void main(String[] args) {
        // 1) Initialisation (crÃ©ation des tables si besoin)
        DatabaseInitializer.initialize();

        try {
            // 2) CrÃ©ation d'un utilisateur de test
            UtilisateurDao userDao = new JdbcUtilisateurDao();
            Utilisateur user = new Utilisateur("caca", "User");
            user.setPassword("pass123");
            userDao.create(user);
            System.out.println("ğŸ‘¤ Utilisateur crÃ©Ã© :");
            System.out.println("    email    = " + user.getEmail());
            System.out.println("    password = pass123");

            // CrÃ©er des utilisateurs avec diffÃ©rents rÃ´les
            Utilisateur admin = new Utilisateur("Admin", "User", "admin123", Role.ADMIN);
            userDao.create(admin);

            Utilisateur enseignant = new Utilisateur("Prof", "User", "prof123", Role.ENSEIGNANT);
            userDao.create(enseignant);

            Utilisateur etudiant = new Utilisateur("Student", "User", "student123", Role.ETUDIANT);
            userDao.create(etudiant);

            // Afficher les informations sur les utilisateurs crÃ©Ã©s
            System.out.println("ğŸ‘‘ Administrateur crÃ©Ã© :");
            System.out.println("    email    = " + admin.getEmail());
            System.out.println("    password = admin123");
            System.out.println("    role     = " + admin.getRole().getLibelle());

            System.out.println("ğŸ§‘â€ğŸ« Enseignant crÃ©Ã© :");
            System.out.println("    email    = " + enseignant.getEmail());
            System.out.println("    password = prof123");
            System.out.println("    role     = " + enseignant.getRole().getLibelle());

            System.out.println("ğŸ§‘â€ğŸ“ Etudiant crÃ©Ã© :");
            System.out.println("    email    = " + etudiant.getEmail());
            System.out.println("    password = student123");
            System.out.println("    role     = " + etudiant.getRole().getLibelle());

            // Tester les mÃ©thodes de vÃ©rification de rÃ´le
            System.out.println("\n--- Test des mÃ©thodes de vÃ©rification de rÃ´le ---");
            System.out.println("admin.isAdmin()      = " + admin.isAdmin());
            System.out.println("admin.isEnseignant() = " + admin.isEnseignant());
            System.out.println("admin.isEtudiant()   = " + admin.isEtudiant());

            System.out.println("enseignant.isAdmin()      = " + enseignant.isAdmin());
            System.out.println("enseignant.isEnseignant() = " + enseignant.isEnseignant());
            System.out.println("enseignant.isEtudiant()   = " + enseignant.isEtudiant());

            // 3) CrÃ©ation d'un cours Â« Test Â»
            CoursDao coursDao = new JdbcCoursDao();
            Cours cours = new Cours("Cours de DÃ©mo", user, 60);
            coursDao.create(cours);
            System.out.println("ğŸ“š Cours crÃ©Ã© : ID=" + cours.getId() + ", nom=" + cours.getNom());

            // 4) CrÃ©ation d'une salle de test
            SalleDao salleDao = new JdbcSalleDao();
            Salle salle = new Salle("Salle T101", 25, "Projecteur");
            salleDao.create(salle);
            System.out.println("ğŸ« Salle crÃ©Ã©e : ID=" + salle.getId() + ", nom=" + salle.getNom());

            // 5) CrÃ©ation de deux crÃ©neaux aujourd'hui
            CreneauDao creneauDao = new JdbcCreneauDao();
            Creneau cr1 = new Creneau(
                    LocalDate.now(),
                    LocalTime.of(9,  0),
                    LocalTime.of(10, 0),
                    cours,
                    salle
            );
            creneauDao.create(cr1);
            System.out.println("â° CrÃ©neau 1 crÃ©Ã© : " + cr1.getDate() + " " + cr1.getDebut() + "-" + cr1.getFin());

            Creneau cr2 = new Creneau(
                    LocalDate.now(),
                    LocalTime.of(14, 0),
                    LocalTime.of(15, 30),
                    cours,
                    salle
            );
            creneauDao.create(cr2);
            System.out.println("â° CrÃ©neau 2 crÃ©Ã© : " + cr2.getDate() + " " + cr2.getDebut() + "-" + cr2.getFin());

        } catch (SQLException e) {
            System.err.println("âŒ Erreur lors du peuplement : " + e.getMessage());
            e.printStackTrace();
            return;
        }

        System.out.println("âœ… Peuplement terminÃ©, tu peux maintenant lancer l'application et te connecter.");
    }
}