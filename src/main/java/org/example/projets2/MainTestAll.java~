package org.example.projets2;

import org.example.projets2.dao.*;
import org.example.projets2.model.*;
import org.example.projets2.util.DatabaseInitializer;

import java.sql.SQLException;
import java.time.LocalDate;
import java.time.LocalTime;
import java.util.List;

public class MainTestAll {

    public static void main(String[] args) {
        // 1) Initialisation (cr√©ation des tables si besoin)
        DatabaseInitializer.initialize();

        try {
            // 2) Cr√©ation d‚Äôun utilisateur de test
            UtilisateurDao userDao = new JdbcUtilisateurDao();
            Utilisateur user = new Utilisateur("Test", "User");
            user.setPassword("pass123");
            userDao.create(user);
            System.out.println("üë§ Utilisateur cr√©√© :");
            System.out.println("    email    = " + user.getEmail());
            System.out.println("    password = pass123");

            // 3) Cr√©ation d‚Äôun cours ¬´ Test ¬ª
            CoursDao coursDao = new JdbcCoursDao();
            Cours cours = new Cours("Cours de D√©mo", user, 60);
            coursDao.create(cours);
            System.out.println("üìö Cours cr√©√© : ID=" + cours.getId() + ", nom=" + cours.getNom());

            // 4) Cr√©ation d‚Äôune salle de test
            SalleDao salleDao = new JdbcSalleDao();
            Salle salle = new Salle("Salle T101", 25, "Projecteur");
            salleDao.create(salle);
            System.out.println("üè´ Salle cr√©√©e : ID=" + salle.getId() + ", nom=" + salle.getNom());

            // 5) Cr√©ation de deux cr√©neaux aujourd‚Äôhui
            CreneauDao creneauDao = new JdbcCreneauDao();
            Creneau cr1 = new Creneau(
                    LocalDate.now(),
                    LocalTime.of(9,  0),
                    LocalTime.of(10, 0),
                    cours,
                    salle
            );
            creneauDao.create(cr1);
            System.out.println("‚è∞ Cr√©neau 1 cr√©√© : " + cr1.getDate() + " " + cr1.getDebut() + "-" + cr1.getFin());

            Creneau cr2 = new Creneau(
                    LocalDate.now(),
                    LocalTime.of(14, 0),
                    LocalTime.of(15, 30),
                    cours,
                    salle
            );
            creneauDao.create(cr2);
            System.out.println("‚è∞ Cr√©neau 2 cr√©√© : " + cr2.getDate() + " " + cr2.getDebut() + "-" + cr2.getFin());

        } catch (SQLException e) {
            System.err.println("‚ùå Erreur lors du peuplement : " + e.getMessage());
            e.printStackTrace();
            return;
        }

        System.out.println("‚úÖ Peuplement termin√©, tu peux maintenant lancer l'application et te connecter.");
    }
}